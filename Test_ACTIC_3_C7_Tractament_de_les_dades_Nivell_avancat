<!DOCTYPE html>
<html lang="ca">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Test ACTIC 3 – C7 Tractament de les dades (Exhaustiu)</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    /* Estils per a les opcions de resposta */
    .option {
      @apply bg-gray-100 p-3 rounded-md mb-2 cursor-pointer border border-gray-200;
    }
    .option:hover {
      @apply bg-gray-200;
    }
    .option.selected {
      @apply bg-blue-200 border-blue-500;
    }
    .option.correct {
      @apply bg-green-200 border-green-500;
    }
    .option.incorrect {
      @apply bg-red-200 border-red-500;
    }
    /* Estils per a les preguntes de tipus 'parelles' */
    .matching-container {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    .matching-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 10px;
      padding: 8px;
      border: 1px solid #e2e8f0;
      border-radius: 6px;
      background-color: #f7fafc;
    }
    .matching-row.correct {
        background-color: #d1fae5; /* bg-green-100 */
        border-color: #34d399; /* border-green-500 */
    }
    .matching-row.incorrect {
        background-color: #fee2e2; /* bg-red-100 */
        border-color: #ef4444; /* border-red-500 */
    }
    .matching-left {
      font-weight: 500;
      flex-basis: 50%;
    }
    .matching-select {
      flex-basis: 50%;
      padding: 6px 10px;
      border-radius: 4px;
      border: 1px solid #cbd5e0;
      background-color: white;
    }
  </style>
</head>
<body class="bg-gray-100 text-gray-900 min-h-screen flex flex-col items-center p-2">
  <div id="app" class="w-full max-w-6xl bg-white p-4 rounded-xl shadow-lg text-sm">
    <h1 class="text-lg font-semibold text-center leading-tight mb-2">
      Test ACTIC 3 – C7 Tractament de les dades, nivell avançat (Exhaustiu)
    </h1>

    <div id="barra-nivells" class="flex gap-2 flex-wrap justify-center mb-4">
      <button onclick="iniciaNivell(1)" class="bg-blue-500 text-white px-3 py-1 rounded hover:bg-blue-600">
        Mòdul 1: Eines BD
      </button>
      <button onclick="iniciaNivell(2)" class="bg-green-500 text-white px-3 py-1 rounded hover:bg-green-600">
        Mòdul 2: Taules avançades
      </button>
      <button onclick="iniciaNivell(3)" class="bg-yellow-500 text-white px-3 py-1 rounded hover:bg-yellow-600">
        Mòdul 3: Consultes avançades
      </button>
      <button onclick="iniciaNivell(4)" class="bg-purple-500 text-white px-3 py-1 rounded hover:bg-purple-600">
        Mòdul 4: Formularis avançats
      </button>
      <button onclick="iniciaNivell(5)" class="bg-red-500 text-white px-3 py-1 rounded hover:bg-red-600">
        Mòdul 5: Informes avançats
      </button>
    </div>

    <div id="content" class="p-4 border border-gray-200 rounded-lg hidden">
      <div id="progress-bar-container" class="w-full bg-gray-200 rounded-full h-2 mb-4">
        <div id="progress-bar" class="bg-blue-500 h-2 rounded-full" style="width: 0%;"></div>
      </div>

      <div id="question-container" class="mb-4">
        <p id="question-text" class="text-base font-medium mb-3"></p>
        <div id="options-container" class="flex flex-col">
          </div>
        <div id="matching-container" class="matching-container hidden">
          </div>
      </div>

      <div id="feedback" class="mb-4 text-center font-bold"></div>
      <div class="flex justify-between items-center">
        <button id="checkBtn" class="bg-blue-500 text-white px-5 py-2 rounded-md hover:bg-blue-600 focus:outline-none">
          Comprovar
        </button>
        <p id="score" class="text-lg font-bold">Encerts: 0 / 0</p>
        <button id="nextBtn" class="bg-green-500 text-white px-5 py-2 rounded-md hover:bg-green-600 focus:outline-none hidden">
          Següent
        </button>
      </div>
      <button id="restartBtn" class="bg-red-500 text-white px-4 py-2 rounded-md hover:bg-red-600 focus:outline-none mt-4 w-full hidden">
        Reiniciar Test
      </button>
    </div>
  </div>

  <script>
    let preguntes = {}; // Aquest objecte s'omplirà amb les preguntes de cada mòdul

    // Mòdul 1: Utilització d'eines de bases de dades (Ja ampliat en la resposta anterior)
    preguntes.modul_1 = {
      titol: "Mòdul 1: Utilització d'eines de bases de dades",
      preguntes: [
        {
          id: "C7M1Q1",
          tipus: "multiseleccio",
          text: "Quins elements són part fonamental de la interfície d'usuari d'un programa de bases de dades com LibreOffice Base o Microsoft Access?",
          opcions: [
            "Barra de títol",
            "Cinta d'opcions (o menús i barres d'eines)",
            "Panell de navegació (o Panell d'objectes)",
            "Barra d'estat",
            "Diapositives de presentació"
          ],
          correcta: ["Barra de títol", "Cinta d'opcions (o menús i barres d'eines)", "Panell de navegació (o Panell d'objectes)", "Barra d'estat"],
          dificultat: "fàcil"
        },
        {
          id: "C7M1Q2",
          tipus: "unica",
          text: "Quin objecte d'una base de dades s'utilitza principalment per a l'emmagatzemament estructurat de la informació?",
          opcions: [
            "Formulari",
            "Informe",
            "Taula",
            "Consulta"
          ],
          correcta: "Taula",
          dificultat: "fàcil"
        },
        {
          id: "C7M1Q3",
          tipus: "multiseleccio",
          text: "Quines de les següents són vistes habituals per treballar amb objectes d'una base de dades (p. ex., taules o consultes)?",
          opcions: [
            "Vista Disseny",
            "Vista Full de dades (o Vista Quadre)",
            "Vista SQL",
            "Vista Esquema"
          ],
          correcta: ["Vista Disseny", "Vista Full de dades (o Vista Quadre)", "Vista SQL"],
          dificultat: "mitjana"
        },
        {
          id: "C7M1Q4",
          tipus: "unica",
          text: "Des de quin menú o secció de la cinta s'accedeix normalment a les opcions de 'Desar', 'Obrir' o 'Crear' una base de dades nova?",
          opcions: [
            "Dades Externes",
            "Crear",
            "Fitxer",
            "Eines de la Base de dades"
          ],
          correcta: "Fitxer",
          dificultat: "fàcil"
        },
        {
          id: "C7M1Q5",
          tipus: "unica",
          text: "Quina funcionalitat d'un programa de bases de dades permet optimitzar el rendiment de l'aplicació i reduir la mida del fitxer de la base de dades?",
          opcions: [
            "Executar consultes d'acció",
            "Compactar i reparar base de dades",
            "Importar dades d'Excel",
            "Crear un formulari d'entrada"
          ],
          correcta: "Compactar i reparar base de dades",
          dificultat: "mitjana"
        },
        {
          id: "C7M1Q6",
          tipus: "multiseleccio",
          text: "Quins tipus d'arxius externs són comunament compatibles per a la importació o exportació de dades en una base de dades relacional?",
          opcions: [
            "Fulls de càlcul (Excel, Calc)",
            "Documents de text (CSV, TXT)",
            "Bases de dades d'altres formats (ODBC, dBase)",
            "Fitxers d'imatge (JPG, PNG)",
            "Fitxers de vídeo (MP4, AVI)"
          ],
          correcta: ["Fulls de càlcul (Excel, Calc)", "Documents de text (CSV, TXT)", "Bases de dades d'altres formats (ODBC, dBase)"],
          dificultat: "mitjana"
        },
        {
            id: "C7M1Q7",
            tipus: "unica",
            text: "Quin objecte de base de dades és el més adequat per extreure i combinar dades de diverses taules segons criteris específics?",
            opcions: [
                "Formulari",
                "Informe",
                "Consulta",
                "Taula"
            ],
            correcta: "Consulta",
            dificultat: "fàcil"
        },
        {
            id: "C7M1Q8",
            tipus: "multiseleccio",
            text: "Quan es guarda una base de dades per primera vegada, quines decisions importants ha de prendre l'usuari?",
            opcions: [
                "El nom de l'arxiu de la base de dades.",
                "La ubicació on es desarà l'arxiu.",
                "El tipus de xifratge de la base de dades (si cal seguretat).",
                "Els noms de tots els camps de totes les taules."
            ],
            correcta: ["El nom de l'arxiu de la base de dades.", "La ubicació on es desarà l'arxiu.", "El tipus de xifratge de la base de dades (si cal seguretat)."],
            dificultat: "mitjana"
        },
        {
            id: "C7M1Q9",
            tipus: "unica",
            text: "Quina icona representa habitualment l'objecte 'Informe' en el panell de navegació d'una base de dades?",
            opcions: [
                "Una graella de cel·les",
                "Un full amb un gràfic",
                "Una pantalla amb camps d'entrada",
                "Un cilindre o pila de discos"
            ],
            correcta: "Un full amb un gràfic",
            dificultat: "difícil"
        },
        {
            id: "C7M1Q10",
            tipus: "unica",
            text: "Quin és el propòsit principal de la 'Barra d'accés ràpid' en la interfície d'una aplicació de bases de dades?",
            opcions: [
                "Mostrar informació sobre l'estat actual de la base de dades.",
                "Accedir ràpidament a les opcions més freqüentment utilitzades (desar, desfer, refer, etc.).",
                "Permetre la navegació entre els diferents objectes de la base de dades.",
                "Visualitzar els camps i les seves propietats en una taula."
            ],
            correcta: "Accedir ràpidament a les opcions més freqüentment utilitzades (desar, desfer, refer, etc.).",
            dificultat: "fàcil"
        },
        {
            id: "C7M1Q11",
            tipus: "multiseleccio",
            text: "Quines de les següents afirmacions són certes sobre la creació d'una nova base de dades des de zero?",
            opcions: [
                "Es pot crear una base de dades buida sense cap taula predefinida.",
                "És obligatori utilitzar un assistent predefinit per crear una base de dades nova.",
                "Es pot triar la ubicació i el nom de l'arxiu des del principi.",
                "La base de dades sempre es crea amb una taula anomenada 'Taula1' per defecte."
            ],
            correcta: ["Es pot crear una base de dades buida sense cap taula predefinida.", "Es pot triar la ubicació i el nom de l'arxiu des del principi."],
            dificultat: "mitjana"
        },
        {
            id: "C7M1Q12",
            tipus: "unica",
            text: "Si necessites transferir dades d'un fitxer CSV (valors separats per comes) a una taula existent a la teva base de dades, quina operació realitzaries?",
            opcions: [
                "Exportar",
                "Compactar",
                "Importar",
                "Reparar"
            ],
            correcta: "Importar",
            dificultat: "fàcil"
        },
        {
            id: "C7M1Q13",
            tipus: "multiseleccio",
            text: "En la configuració de les opcions de l'aplicació de base de dades (per exemple, a les preferències o opcions d'Access/Base), quins aspectes generals es poden personalitzar?",
            opcions: [
                "La carpeta per defecte per desar els fitxers.",
                "El nom de les taules i camps existents.",
                "Les opcions de correcció automàtica (AutoCorrecció).",
                "La interfície d'usuari (temes, colors, etc.)."
            ],
            correcta: ["La carpeta per defecte per desar els fitxers.", "Les opcions de correcció automàtica (AutoCorrecció).", "La interfície d'usuari (temes, colors, etc.)."],
            dificultat: "mitjana"
        },
        {
            id: "C7M1Q14",
            tipus: "unica",
            text: "Quina és la utilitat de protegir una base de dades amb una contrasenya?",
            opcions: [
                "Augmentar la mida del fitxer de la base de dades per millorar el rendiment.",
                "Permetre que qualsevol usuari hi accedeixi sense restriccions.",
                "Restringir l'accés no autoritzat al contingut de la base de dades.",
                "Automatitzar la creació de còpies de seguretat."
            ],
            correcta: "Restringir l'accés no autoritzat al contingut de la base de dades.",
            dificultat: "fàcil"
        }
      ]
    };

    // Mòdul 2: Gestió avançada de taules
    preguntes.modul_2 = {
      titol: "Mòdul 2: Gestió avançada de taules",
      preguntes: [
        {
          id: "C7M2Q1",
          tipus: "parelles",
          text: "Associa cada tipus de dada amb la seva aplicació més adequada:",
          opcions: [
            { esquerra: "Text curt (VARCHAR)", disponible: ["Quantitats monetàries o preus.", "Adreces de correu electrònic.", "Nombres enters grans.", "Informació de contacte com noms i cognoms."] },
            { esquerra: "Numèric (Enter)", disponible: ["Quantitats monetàries o preus.", "Adreces de correu electrònic.", "Nombres enters grans.", "Informació de contacte com noms i cognoms."] },
            { esquerra: "Moneda", disponible: ["Quantitats monetàries o preus.", "Adreces de correu electrònic.", "Nombres enters grans.", "Informació de contacte com noms i cognoms."] },
            { esquerra: "Data/Hora", disponible: ["Feches de naixement, d'alta o de lliurament.", "Valors de sí o no.", "URLs de pàgines web.", "Grans blocs de text."] }
          ],
          parelles: [
            { esquerra: "Text curt (VARCHAR)", correcta: "Informació de contacte com noms i cognoms." },
            { esquerra: "Numèric (Enter)", correcta: "Nombres enters grans." },
            { esquerra: "Moneda", correcta: "Quantitats monetàries o preus." },
            { esquerra: "Data/Hora", correcta: "Feches de naixement, d'alta o de lliurament." }
          ],
          dificultat: "fàcil"
        },
        {
          id: "C7M2Q2",
          tipus: "multiseleccio",
          text: "Quines de les següents són propietats que es poden establir per a un camp en la vista de disseny d'una taula?",
          opcions: [
            "Mida del camp (per a text o numèrics)",
            "Valor per defecte",
            "Màscara d'entrada",
            "Regla de validació",
            "Color de fons de la cel·la"
          ],
          correcta: ["Mida del camp (per a text o numèrics)", "Valor per defecte", "Màscara d'entrada", "Regla de validació"],
          dificultat: "mitjana"
        },
        {
          id: "C7M2Q3",
          tipus: "unica",
          text: "Una 'clau primària' és un camp o conjunt de camps que identifica de forma única cada registre d'una taula. Quina de les següents afirmacions és FALSA sobre les claus primàries?",
          opcions: [
            "Els valors en un camp de clau primària no poden ser nuls.",
            "Una taula pot tenir múltiples claus primàries actives simultàniament.",
            "Els valors en un camp de clau primària no poden estar duplicats.",
            "S'utilitza per establir relacions amb altres taules."
          ],
          correcta: "Una taula pot tenir múltiples claus primàries actives simultàniament.",
          dificultat: "difícil"
        },
        {
          id: "C7M2Q4",
          tipus: "unica",
          text: "Què és una 'clau forana' en el context de les bases de dades relacionals?",
          opcions: [
            "Un camp que garanteix la unicitat de tots els registres en una base de dades.",
            "Un camp en una taula que es relaciona amb la clau primària d'una altra taula.",
            "Una clau de seguretat per accedir a la base de dades.",
            "Un camp utilitzat per ordenar els resultats d'una consulta."
          ],
          correcta: "Un camp en una taula que es relaciona amb la clau primària d'una altra taula.",
          dificultat: "mitjana"
        },
        {
          id: "C7M2Q5",
          tipus: "multiseleccio",
          text: "Quins tipus de relacions es poden establir entre taules en una base de dades relacional?",
          opcions: [
            "Un a un",
            "Un a molts",
            "Molts a molts (sovint a través d'una taula intermèdia)",
            "Circular"
          ],
          correcta: ["Un a un", "Un a molts", "Molts a molts (sovint a través d'una taula intermèdia)"],
          dificultat: "fàcil"
        },
        {
          id: "C7M2Q6",
          tipus: "unica",
          text: "Què s'aconsegueix habilitant la 'integritat referencial' en una relació entre taules?",
          opcions: [
            "Assegurar que les dades en la taula relacionada siguin consistents amb les dades en la taula principal, evitant registres orfes.",
            "Augmentar la velocitat de les consultes en taules grans.",
            "Permetre la introducció de dades duplicades per a una major flexibilitat.",
            "Automàticament importar dades de fonts externes."
          ],
          correcta: "Assegurar que les dades en la taula relacionada siguin consistents amb les dades en la taula principal, evitant registres orfes.",
          dificultat: "difícil"
        },
        {
          id: "C7M2Q7",
          tipus: "multiseleccio",
          text: "Quins són els avantatges principals de la indexació d'un o més camps en una taula?",
          opcions: [
            "Accelerar la recerca de registres.",
            "Millorar el rendiment en les operacions d'ordenació.",
            "Reduir la mida de la base de dades en el disc.",
            "Garantir la unicitat dels registres (si és un índex únic)."
          ],
          correcta: ["Accelerar la recerca de registres.", "Millorar el rendiment en les operacions d'ordenació.", "Garantir la unicitat dels registres (si és un índex únic)"],
          dificultat: "mitjana"
        },
        {
            id: "C7M2Q8",
            tipus: "unica",
            text: "Quin tipus de dada és el més adequat per emmagatzemar una URL (adreça web)?",
            opcions: [
                "Número llarg",
                "Booleà",
                "Hiperenllaç",
                "Moneda"
            ],
            correcta: "Hiperenllaç",
            dificultat: "fàcil"
        },
        {
            id: "C7M2Q9",
            tipus: "multiseleccio",
            text: "En el disseny d'una taula, quina de les següents opcions et permet establir un valor que s'introduirà automàticament en un camp si l'usuari no n'especifica un?",
            opcions: [
                "Màscara d'entrada",
                "Regla de validació",
                "Valor per defecte",
                "Títol del camp"
            ],
            correcta: ["Valor per defecte"],
            dificultat: "fàcil"
        },
        {
            id: "C7M2Q10",
            tipus: "unica",
            text: "Quina és la funció de la propietat 'Requerit' d'un camp en el disseny d'una taula?",
            opcions: [
                "Fa que el camp sigui una clau primària.",
                "Impedeix que el camp contingui valors nuls (buits).",
                "Determina la mida màxima del text en el camp.",
                "Defineix el format de presentació de les dades del camp."
            ],
            correcta: "Impedeix que el camp contingui valors nuls (buits).",
            dificultat: "mitjana"
        },
        {
            id: "C7M2Q11",
            tipus: "unica",
            text: "Si has de canviar el tipus de dada d'un camp existent en una taula que ja conté registres, quina és la consideració més important a tenir en compte?",
            opcions: [
                "Sempre es pot canviar el tipus de dada sense cap risc.",
                "Cal assegurar-se que les dades existents siguin compatibles amb el nou tipus de dada per evitar pèrdues o errors.",
                "La base de dades compactarà automàticament les dades després del canvi.",
                "Només es pot fer des de la vista Full de dades."
            ],
            correcta: "Cal assegurar-se que les dades existents siguin compatibles amb el nou tipus de dada per evitar pèrdues o errors.",
            dificultat: "difícil"
        },
        {
            id: "C7M2Q12",
            tipus: "multiseleccio",
            text: "Quines accions pots realitzar per modificar l'estructura d'una taula existent en la vista de disseny?",
            opcions: [
                "Afegir nous camps.",
                "Eliminar camps existents.",
                "Canviar el tipus de dada d'un camp.",
                "Modificar el contingut de les dades dels registres.",
                "Reordenar els camps."
            ],
            correcta: ["Afegir nous camps.", "Eliminar camps existents.", "Canviar el tipus de dada d'un camp.", "Reordenar els camps."],
            dificultat: "mitjana"
        },
        {
            id: "C7M2Q13",
            tipus: "unica",
            text: "Quin és l'objectiu principal d'utilitzar una 'màscara d'entrada' per a un camp de text?",
            opcions: [
                "Definir el nombre màxim de caràcters permesos.",
                "Garantir un format de dades consistent (p. ex., dates, codis postals) a l'hora d'introduir-los.",
                "Convertir el text a majúscules o minúscules automàticament.",
                "Bloquejar la introducció de dades en el camp."
            ],
            correcta: "Garantir un format de dades consistent (p. ex., dates, codis postals) a l'hora d'introduir-los.",
            dificultat: "mitjana"
        },
        {
            id: "C7M2Q14",
            tipus: "multiseleccio",
            text: "Quins tipus de dades són adequats per a camps que s'utilitzaran com a clau primària o clau forana, donada la seva naturalesa única o d'identificador?",
            opcions: [
                "Text llarg",
                "Numèric (Enter llarg, Autonumèric)",
                "Data/Hora",
                "Sí/No (Booleà)"
            ],
            correcta: ["Numèric (Enter llarg, Autonumèric)"],
            dificultat: "fàcil"
        },
        {
            id: "C7M2Q15",
            tipus: "unica",
            text: "Quina opció et permet veure de forma ràpida tots els registres relacionats d'una taula secundària directament des d'un registre de la taula principal en la vista Full de dades?",
            opcions: [
                "Panell de tasques de la base de dades.",
                "Subfull de dades.",
                "Mode de filtratge avançat.",
                "Eina d'anàlisi de rendiment."
            ],
            correcta: "Subfull de dades.",
            dificultat: "difícil"
        }
      ]
    };

    // Mòdul 3: Consultes avançades
    preguntes.modul_3 = {
      titol: "Mòdul 3: Consultes avançades",
      preguntes: [
        {
          id: "C7M3Q1",
          tipus: "parelles",
          text: "Associa cada tipus de consulta amb la seva acció principal:",
          opcions: [
            { esquerra: "Consulta de selecció", disponible: ["Recupera i mostra dades basant-se en criteris.", "Afegeix nous registres a una taula.", "Modifica el contingut de registres existents.", "Elimina registres d'una o més taules."] },
            { esquerra: "Consulta d'inserció", disponible: ["Recupera i mostra dades basant-se en criteris.", "Afegeix nous registres a una taula.", "Modifica el contingut de registres existents.", "Elimina registres d'una o més taules."] },
            { esquerra: "Consulta d'actualització", disponible: ["Recupera i mostra dades basant-se en criteris.", "Afegeix nous registres a una taula.", "Modifica el contingut de registres existents.", "Elimina registres d'una o més taules."] },
            { esquerra: "Consulta d'eliminació", disponible: ["Recupera i mostra dades basant-se en criteris.", "Afegeix nous registres a una taula.", "Modifica el contingut de registres existents.", "Elimina registres d'una o més taules."] }
          ],
          parelles: [
            { esquerra: "Consulta de selecció", correcta: "Recupera i mostra dades basant-se en criteris." },
            { esquerra: "Consulta d'inserció", correcta: "Afegeix nous registres a una taula." },
            { esquerra: "Consulta d'actualització", correcta: "Modifica el contingut de registres existents." },
            { esquerra: "Consulta d'eliminació", correcta: "Elimina registres d'una o més taules." }
          ],
          dificultat: "mitjana"
        },
        {
          id: "C7M3Q2",
          tipus: "unica",
          text: "Quin operador s'utilitza en els criteris d'una consulta per trobar registres que compleixen *totes* les condicions especificades?",
          opcions: [
            "OR",
            "NOT",
            "LIKE",
            "AND"
          ],
          correcta: "AND",
          dificultat: "fàcil"
        },
        {
          id: "C7M3Q3",
          tipus: "multiseleccio",
          text: "Quines de les següents són funcions d'agregació habituals per realitzar càlculs en grups de dades dins d'una consulta (p. ex., amb una fila de totals)?",
          opcions: [
            "SUM (Suma)",
            "AVG (Mitjana)",
            "COUNT (Comptar)",
            "MAX (Màxim)",
            "MIN (Mínim)",
            "CONCATENATE (Concatenar text)"
          ],
          correcta: ["SUM (Suma)", "AVG (Mitjana)", "COUNT (Comptar)", "MAX (Màxim)", "MIN (Mínim)"],
          dificultat: "mitjana"
        },
        {
          id: "C7M3Q4",
          tipus: "unica",
          text: "Què és una consulta amb paràmetres?",
          opcions: [
            "Una consulta que sempre retorna els mateixos resultats.",
            "Una consulta que sol·licita un valor a l'usuari cada vegada que s'executa per filtrar els resultats.",
            "Una consulta que només es pot executar des de la vista SQL.",
            "Una consulta que crea automàticament nous camps a la taula."
          ],
          correcta: "Una consulta que sol·licita un valor a l'usuari cada vegada que s'executa per filtrar els resultats.",
          dificultat: "mitjana"
        },
        {
          id: "C7M3Q5",
          tipus: "multiseleccio",
          text: "En una consulta de selecció, quines accions es poden dur a terme amb els camps afegits a la graella de disseny?",
          opcions: [
            "Visualitzar el camp en els resultats.",
            "Establir criteris de filtratge.",
            "Ordenar els resultats per aquest camp.",
            "Realitzar càlculs (expressions)."
          ],
          correcta: ["Visualitzar el camp en els resultats.", "Establir criteris de filtratge.", "Ordenar els resultats per aquest camp.", "Realitzar càlculs (expressions)"],
          dificultat: "fàcil"
        },
        {
          id: "C7M3Q6",
          tipus: "unica",
          text: "Quin tipus de consulta crea una nova taula a partir de les dades seleccionades d'una o més taules existents?",
          opcions: [
            "Consulta d'actualització",
            "Consulta de creació de taula",
            "Consulta d'eliminació",
            "Consulta de referència"
          ],
          correcta: "Consulta de creació de taula",
          dificultat: "mitjana"
        },
        {
          id: "C7M3Q7",
          tipus: "multiseleccio",
          text: "Quins operadors de comparació són habituals en els criteris d'una consulta?",
          opcions: [
            "=",
            "<> (Diferent de)",
            ">, <, >=, <=",
            "BETWEEN...AND...",
            "IS NULL / IS NOT NULL"
          ],
          correcta: ["=", "<> (Diferent de)", ">, <, >=, <=", "BETWEEN...AND...", "IS NULL / IS NOT NULL"],
          dificultat: "mitjana"
        },
        {
            id: "C7M3Q8",
            tipus: "unica",
            text: "Si necessites unir registres de dues taules basant-te en un camp comú, però incloent tots els registres d'una taula encara que no tinguin coincidència en l'altra, quin tipus d'unió utilitzaries?",
            opcions: [
                "Inner Join (Unió interna)",
                "Left Join (Unió esquerra)",
                "Right Join (Unió dreta)",
                "Full Join (Unió completa)"
            ],
            correcta: "Left Join (Unió esquerra)",
            dificultat: "difícil"
        },
        {
            id: "C7M3Q9",
            tipus: "unica",
            text: "Quin objectiu té la vista SQL en una consulta?",
            opcions: [
                "Permetre la introducció de dades directament en la consulta.",
                "Mostrar una representació visual de la consulta amb taules i línies de relació.",
                "Permetre escriure o modificar la consulta mitjançant codi Structured Query Language.",
                "Imprimir els resultats de la consulta."
            ],
            correcta: "Permetre escriure o modificar la consulta mitjançant codi Structured Query Language.",
            dificultat: "mitjana"
        },
        {
            id: "C7M3Q10",
            tipus: "unica",
            text: "Quan s'utilitza l'operador 'LIKE' en un criteri de consulta, quin caràcter s'utilitza com a comodí per representar qualsevol seqüència de caràcters?",
            opcions: [
                "?",
                "#",
                "%",
                "!"
            ],
            correcta: "%",
            dificultat: "mitjana"
        }
      ]
    };

    // Mòdul 4: Formularis avançats
    preguntes.modul_4 = {
      titol: "Mòdul 4: Formularis avançats",
      preguntes: [
        {
          id: "C7M4Q1",
          tipus: "unica",
          text: "Quin és l'objectiu principal d'un formulari en una base de dades des del punt de vista de l'usuari final?",
          opcions: [
            "Emmagatzemar la totalitat de les dades de la base de dades.",
            "Generar informes imprimibles de forma automàtica.",
            "Proporcionar una interfície amigable per introduir, veure i modificar dades sense interactuar directament amb les taules.",
            "Crear noves taules i relacions entre elles."
          ],
          correcta: "Proporcionar una interfície amigable per introduir, veure i modificar dades sense interactuar directament amb les taules.",
          dificultat: "fàcil"
        },
        {
          id: "C7M4Q2",
          tipus: "multiseleccio",
          text: "Quins tipus de controls interactius són comuns en el disseny de formulari per a l'entrada de dades?",
          opcions: [
            "Quadres de text (TextBox)",
            "Etiquetes (Label)",
            "Quadres combinats (ComboBox)",
            "Caselles de verificació (CheckBox)",
            "Barres de desplaçament (ScrollBar)"
          ],
          correcta: ["Quadres de text (TextBox)", "Quadres combinats (ComboBox)", "Caselles de verificació (CheckBox)"],
          dificultat: "fàcil"
        },
        {
          id: "C7M4Q3",
          tipus: "unica",
          text: "Per a què serveix un 'subformulari'?",
          opcions: [
            "Per crear un formulari independent que no es relaciona amb cap taula.",
            "Per inserir un formulari dins d'un altre formulari per mostrar dades relacionades (p. ex., articles d'una comanda en el formulari de comanda).",
            "Per establir paràmetres de seguretat en un formulari.",
            "Per automatitzar la creació de nous formularis."
          ],
          correcta: "Per inserir un formulari dins d'un altre formulari per mostrar dades relacionades (p. ex., articles d'una comanda en el formulari de comanda).",
          dificultat: "mitjana"
        },
        {
          id: "C7M4Q4",
          tipus: "multiseleccio",
          text: "Quines són consideracions importants a tenir en compte en el disseny visual d'un formulari per millorar l'experiència de l'usuari?",
          opcions: [
            "La distribució lògica dels camps.",
            "La claredat de les etiquetes i instruccions.",
            "L'ús consistent de colors i tipografies.",
            "La inclusió de camps de text llargs per a tots els camps."
          ],
          correcta: ["La distribució lògica dels camps.", "La claredat de les etiquetes i instruccions.", "L'ús consistent de colors i tipografies."],
          dificultat: "fàcil"
        },
        {
          id: "C7M4Q5",
          tipus: "unica",
          text: "Quin tipus de control permet a l'usuari triar un valor d'una llista predefinida de possibilitats, evitant errors d'introducció?",
          opcions: [
            "Botó de comandament",
            "Quadre de llista o quadre combinat",
            "Botó d'opció",
            "Camp de text"
          ],
          correcta: "Quadre de llista o quadre combinat",
          dificultat: "fàcil"
        },
        {
            id: "C7M4Q6",
            tipus: "unica",
            text: "Quin objecte de base de dades pot ser utilitzat com a origen de dades per a un formulari?",
            opcions: [
                "Un altre formulari",
                "Un informe",
                "Una taula o una consulta",
                "Una macro"
            ],
            correcta: "Una taula o una consulta",
            dificultat: "fàcil"
        },
        {
            id: "C7M4Q7",
            tipus: "multiseleccio",
            text: "Quines vistes són comunes en l'edició i manipulació de formularis?",
            opcions: [
                "Vista Formulari (per a l'entrada de dades)",
                "Vista Disseny (per modificar l'estructura)",
                "Vista Presentació (per ajustar el disseny amb dades reals)",
                "Vista SQL"
            ],
            correcta: ["Vista Formulari (per a l'entrada de dades)", "Vista Disseny (per modificar l'estructura)", "Vista Presentació (per ajustar el disseny amb dades reals)"],
            dificultat: "mitjana"
        },
        {
            id: "C7M4Q8",
            tipus: "unica",
            text: "Quina de les següents afirmacions és correcta respecte als botons de comandament en els formularis?",
            opcions: [
                "Només es poden utilitzar per navegar entre registres.",
                "Permeten executar accions predefinides o macros personalitzades en fer-hi clic.",
                "Són controls que mostren dades de la base de dades.",
                "No es poden personalitzar amb text o imatges."
            ],
            correcta: "Permeten executar accions predefinides o macros personalitzades en fer-hi clic.",
            dificultat: "mitjana"
        }
      ]
    };

    // Mòdul 5: Informes avançats
    preguntes.modul_5 = {
      titol: "Mòdul 5: Informes avançats",
      preguntes: [
        {
          id: "C7M5Q1",
          tipus: "unica",
          text: "Quin és el propòsit fonamental d'un informe en una base de dades?",
          opcions: [
            "Permetre la introducció interactiva de grans volums de dades.",
            "Realitzar càlculs matemàtics complexos sobre dades en temps real.",
            "Presentar dades de manera estructurada, formatada i resumida per a la visualització o impressió.",
            "Establir relacions entre diferents taules de la base de dades."
          ],
          correcta: "Presentar dades de manera estructurada, formatada i resumida per a la visualització o impressió.",
          dificultat: "fàcil"
        },
        {
          id: "C7M5Q2",
          tipus: "multiseleccio",
          text: "Quines són les seccions habituals que es poden configurar en el disseny d'un informe per organitzar el contingut?",
          opcions: [
            "Capçalera de l'informe / Peu de l'informe (general)",
            "Capçalera de pàgina / Peu de pàgina",
            "Capçalera de grup / Peu de grup (per a agrupacions de dades)",
            "Secció de detall (per a les dades individuals)",
            "Secció de controls"
          ],
          correcta: ["Capçalera de l'informe / Peu de l'informe (general)", "Capçalera de pàgina / Peu de pàgina", "Capçalera de grup / Peu de grup (per a agrupacions de dades)", "Secció de detall (per a les dades individuals)"],
          dificultat: "mitjana"
        },
        {
          id: "C7M5Q3",
          tipus: "unica",
          text: "Si vols sumar els totals de vendes per a cada client en un informe, quina funcionalitat utilitzaries en el disseny de l'informe?",
          opcions: [
            "Ordenació de registres sense agrupació.",
            "Aplicar un filtre simple a les dades.",
            "Establir agrupament per client i afegir una funció de suma al peu de grup.",
            "Utilitzar una consulta d'acció."
          ],
          correcta: "Establir agrupament per client i afegir una funció de suma al peu de grup.",
          dificultat: "difícil"
        },
        {
          id: "C7M5Q4",
          tipus: "multiseleccio",
          text: "Quines propietats de formatació són essencials per a un informe ben presentat?",
          opcions: [
            "Tipografia i mida de lletra.",
            "Colors i ressaltats (si escau).",
            "Alineació del text i els números.",
            "Estils de línia i contorns."
          ],
          correcta: ["Tipografia i mida de lletra.", "Colors i ressaltats (si escau).", "Alineació del text i els números.", "Estils de línia i contorns."],
          dificultat: "fàcil"
        },
        {
          id: "C7M5Q5",
          tipus: "unica",
          text: "Quin és l'objectiu principal de la 'Previsualització' d'impressió en un informe?",
          opcions: [
            "Introduir dades noves directament en l'informe abans d'imprimir.",
            "Veure com es visualitzarà l'informe un cop imprès i detectar possibles errors de disseny o paginació.",
            "Modificar l'estructura de les taules que alimenten l'informe.",
            "Exportar l'informe a un format de base de dades diferent."
          ],
          correcta: "Veure com es visualitzarà l'informe un cop imprès i detectar possibles errors de disseny o paginació.",
          dificultat: "fàcil"
        },
        {
            id: "C7M5Q6",
            tipus: "multiseleccio",
            text: "Quines de les següents opcions de configuració de pàgina són crucials per a la correcta impressió d'un informe?",
            opcions: [
                "Mida del paper (A4, Letter, etc.).",
                "Orientació del paper (Vertical, Horitzontal).",
                "Marges de la pàgina.",
                "Resolució de la pantalla del monitor."
            ],
            correcta: ["Mida del paper (A4, Letter, etc.).", "Orientació del paper (Vertical, Horitzontal).", "Marges de la pàgina."],
            dificultat: "fàcil"
        },
        {
            id: "C7M5Q7",
            tipus: "unica",
            text: "Quin tipus d'objecte és el més comú que s'utilitza com a origen de dades per a un informe?",
            opcions: [
                "Un formulari d'entrada de dades.",
                "Una taula o una consulta de selecció.",
                "Una macro o mòdul VBA.",
                "Un fitxer de text simple."
            ],
            correcta: "Una taula o una consulta de selecció.",
            dificultat: "fàcil"
        },
        {
            id: "C7M5Q8",
            tipus: "unica",
            text: "En un informe, si desitges que el nom del client aparegui només una vegada quan s'agrupen les vendes per client, on col·locaries el camp del nom del client?",
            opcions: [
                "A la secció de Detall.",
                "Al Peu de Pàgina.",
                "A la Capçalera del Grup (del client).",
                "Al Peu de l'Informe."
            ],
            correcta: "A la Capçalera del Grup (del client).",
            dificultat: "difícil"
        }
      ]
    };

    let currentLevel = 0;
    let currentQuestionIndex = 0;
    let encerts = 0;
    let preguntesRespostes = 0;
    let selectedOptions = new Set();
    let selectedMatching = {};

    const contentDiv = document.getElementById('content');
    const questionText = document.getElementById('question-text');
    const optionsContainer = document.getElementById('options-container');
    const matchingContainer = document.getElementById('matching-container');
    const feedbackDiv = document.getElementById('feedback');
    const scoreSpan = document.getElementById('score');
    const checkBtn = document.getElementById('checkBtn');
    const nextBtn = document.getElementById('nextBtn');
    const restartBtn = document.getElementById('restartBtn');
    const progressBar = document.getElementById('progress-bar');
    const barraNivells = document.getElementById('barra-nivells');

    function iniciaNivell(level) {
      currentLevel = level;
      currentQuestionIndex = 0;
      encerts = 0;
      preguntesRespostes = 0;
      contentDiv.classList.remove('hidden');
      barraNivells.classList.add('hidden'); // Ocultar els botons de nivell

      if (Object.keys(preguntes).length > 0 && preguntes[`modul_${currentLevel}`]) {
        mostraPregunta();
      } else {
        feedbackDiv.innerHTML = "<p class='text-red-600'>Error: Mòdul no trobat.</p>";
      }
      restartBtn.classList.add('hidden');
    }

    function mostraPregunta() {
      selectedOptions.clear();
      selectedMatching = {};
      feedbackDiv.innerHTML = '';
      nextBtn.classList.add('hidden');
      checkBtn.classList.remove('hidden');
      desbloquejaInteraccio();

      const modulActual = preguntes[`modul_${currentLevel}`];
      if (!modulActual || currentQuestionIndex >= modulActual.preguntes.length) {
        finalitzarTest();
        return;
      }

      const actual = modulActual.preguntes[currentQuestionIndex];
      questionText.textContent = actual.text;
      optionsContainer.innerHTML = '';
      matchingContainer.innerHTML = ''; // Neteja l'anterior
      optionsContainer.classList.remove('hidden'); // Mostra per defecte
      matchingContainer.classList.add('hidden'); // Oculta per defecte

      if (actual.tipus === 'unica' || actual.tipus === 'multiseleccio') {
        actual.opcions.forEach((opcio, index) => {
          const div = document.createElement('div');
          div.classList.add('option');
          div.textContent = opcio;
          div.dataset.index = index;
          div.addEventListener('click', () => toggleSelection(div, actual.tipus));
          optionsContainer.appendChild(div);
        });
      } else if (actual.tipus === 'parelles') {
        optionsContainer.classList.add('hidden'); // Oculta les opcions normals
        matchingContainer.classList.remove('hidden'); // Mostra el contenidor d'aparellament

        actual.opcions.forEach(item => {
          const row = document.createElement('div');
          row.classList.add('matching-row');

          const leftSpan = document.createElement('span');
          leftSpan.classList.add('matching-left');
          leftSpan.textContent = item.esquerra;
          row.appendChild(leftSpan);

          const select = document.createElement('select');
          select.classList.add('matching-select');
          select.dataset.esquerra = item.esquerra;
          
          // Afegir una opció per defecte "Selecciona"
          const defaultOption = document.createElement('option');
          defaultOption.value = "";
          defaultOption.textContent = "Selecciona...";
          select.appendChild(defaultOption);

          // Barrejar les opcions disponibles per a cada dropdown
          const shuffledDisponibles = [...item.disponible].sort(() => Math.random() - 0.5);
          shuffledDisponibles.forEach(opt => {
            const option = document.createElement('option');
            option.value = opt;
            option.textContent = opt;
            select.appendChild(option);
          });

          select.addEventListener('change', (e) => {
            selectedMatching[e.target.dataset.esquerra] = e.target.value;
          });
          row.appendChild(select);
          matchingContainer.appendChild(row);
        });
      }
      updateScoreDisplay();
      updateProgress();
    }

    function toggleSelection(div, tipus) {
      if (tipus === 'unica') {
        // Deseleccionar qualsevol altra opció
        optionsContainer.querySelectorAll('.option').forEach(opt => {
          opt.classList.remove('selected');
        });
        selectedOptions.clear();
        div.classList.add('selected');
        selectedOptions.add(div.textContent);
      } else if (tipus === 'multiseleccio') {
        if (div.classList.contains('selected')) {
          div.classList.remove('selected');
          selectedOptions.delete(div.textContent);
        } else {
          div.classList.add('selected');
          selectedOptions.add(div.textContent);
        }
      }
    }

    function comprovarResposta() {
      const modulActual = preguntes[`modul_${currentLevel}`];
      const actual = modulActual.preguntes[currentQuestionIndex];
      let esCorrecta = false;

      if (actual.tipus === 'unica') {
        esCorrecta = selectedOptions.has(actual.correcta);
        optionsContainer.querySelectorAll('.option').forEach(s => {
          if (s.textContent === actual.correcta) {
            s.classList.add('correct');
          } else if (selectedOptions.has(s.textContent)) {
            s.classList.add('incorrect');
          }
        });
      } else if (actual.tipus === 'multiseleccio') {
        const correctesEsperades = new Set(actual.correcta);
        esCorrecta = (selectedOptions.size === correctesEsperades.size &&
                      [...selectedOptions].every(opt => correctesEsperades.has(opt)));

        optionsContainer.querySelectorAll('.option').forEach(s => {
          if (actual.correcta.includes(s.textContent)) {
            s.classList.add('correct');
          } else if (selectedOptions.has(s.textContent)) {
            s.classList.add('incorrect');
          }
        });
      } else if (actual.tipus === 'parelles') {
        let correctes = 0;
        matchingContainer.querySelectorAll('.matching-row').forEach(row => {
          const esquerra = row.querySelector('.matching-left').textContent;
          const select = row.querySelector('.matching-select');
          const respostaSeleccionada = select.value;
          
          const parellaCorrecta = actual.parelles.find(p => p.esquerra === esquerra);

          if (parellaCorrecta && respostaSeleccionada === parellaCorrecta.correcta) {
            row.classList.add('correct');
            correctes++;
          } else {
            row.classList.add('incorrect');
          }
        });
        esCorrecta = (correctes === actual.parelles.length);
      }

      preguntesRespostes++;
      if (esCorrecta) {
        encerts++;
        feedbackDiv.innerHTML = "<p class='text-green-600 font-bold'>😊 Molt bé!</p>";
      } else {
        feedbackDiv.innerHTML = "<p class='text-red-600 font-bold'>❌ Revisa les respostes.</p>";
        // Opcional: Mostrar les respostes correctes per a 'unica' i 'multiseleccio'
        if (actual.tipus === 'unica') {
            feedbackDiv.innerHTML += `<p class='text-sm text-gray-700 mt-1'>La resposta correcta era: <strong>${actual.correcta}</strong></p>`;
        } else if (actual.tipus === 'multiseleccio') {
            feedbackDiv.innerHTML += `<p class='text-sm text-gray-700 mt-1'>Les respostes correctes eren: <strong>${actual.correcta.join(', ')}</strong></p>`;
        } else if (actual.tipus === 'parelles') {
             let respostesCorrectesHtml = "<p class='text-sm text-gray-700 mt-1'>Respostes correctes:</p><ul>";
            actual.parelles.forEach((p) => {
                respostesCorrectesHtml += `<li>${p.esquerra}: <strong>${p.correcta}</strong></li>`;
            });
            respostesCorrectesHtml += "</ul>";
            feedbackDiv.innerHTML += respostesCorrectesHtml;
        }
      }

      updateScoreDisplay();
      nextBtn.classList.remove('hidden');
      checkBtn.classList.add('hidden');
      bloquejaInteraccio();
    }

    function passaSeguent() {
      currentQuestionIndex++;
      const modulActual = preguntes[`modul_${currentLevel}`];
      if (!modulActual || currentQuestionIndex >= modulActual.preguntes.length) {
        finalitzarTest();
        return;
      }
      mostraPregunta();
    }

    function updateScoreDisplay() {
      scoreSpan.textContent = `Encerts: ${encerts} / ${preguntesRespostes}`;
    }

    function updateProgress() {
      const modulActual = preguntes[`modul_${currentLevel}`];
      const totalQuestions = modulActual.preguntes.length;
      // Calcula el progrés basant-se en les preguntes *mostrades* fins ara
      const progress = (currentQuestionIndex / totalQuestions) * 100;
      progressBar.style.width = `${progress}%`;
    }

    function finalitzarTest() {
      questionText.textContent = "Test finalitzat!";
      optionsContainer.innerHTML = '';
      matchingContainer.innerHTML = '';
      feedbackDiv.innerHTML = `<p class='text-xl font-bold'>Has respost ${preguntesRespostes} preguntes i has tingut ${encerts} encerts.</p>`;
      checkBtn.classList.add('hidden');
      nextBtn.classList.add('hidden');
      restartBtn.classList.remove('hidden');
      progressBar.style.width = `100%`; // Completa la barra al final
      scoreSpan.textContent = `Resultat final: ${encerts} / ${preguntesRespostes}`;
    }

    function reiniciarTest() {
      currentLevel = 0;
      currentQuestionIndex = 0;
      encerts = 0;
      preguntesRespostes = 0;
      contentDiv.classList.add('hidden');
      barraNivells.classList.remove('hidden'); // Mostra els botons de nivell
      feedbackDiv.innerHTML = '';
      updateScoreDisplay();
      progressBar.style.width = `0%`;
      restartBtn.classList.add('hidden');
    }

    function bloquejaInteraccio() {
      optionsContainer.querySelectorAll('.option').forEach(opt => opt.style.pointerEvents = 'none');
      matchingContainer.querySelectorAll('.matching-select').forEach(sel => sel.disabled = true);
    }

    function desbloquejaInteraccio() {
      optionsContainer.querySelectorAll('.option').forEach(opt => opt.style.pointerEvents = 'auto');
      matchingContainer.querySelectorAll('.matching-select').forEach(sel => sel.disabled = false);
    }

    // Assignar esdeveniments
    checkBtn.addEventListener('click', comprovarResposta);
    nextBtn.addEventListener('click', passaSeguent);
    restartBtn.addEventListener('click', reiniciarTest);

  </script>
</body>
</html>
